<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš ï¸ è­¦å‘Šå° - ç‡’å¤©è­¦å‘Šæ­·å²åˆ†æ | BurnSky ç‡’å¤©é æ¸¬ç³»çµ±</title>
    <meta name="description" content="ç‡’å¤©é æ¸¬ç³»çµ±è­¦å‘Šå°ï¼Œæ·±åº¦åˆ†æè­¦å‘Šæ­·å²æ•¸æ“šã€æ™‚é–“æ¨¡å¼ã€å­£ç¯€æ€§è¶¨å‹¢å’Œé æ¸¬æº–ç¢ºæ€§è©•ä¼°ã€‚">
    
         <div class="nav-container">
            <div class="nav-row">
                <a href="/">ğŸ  é¦–é </a>
                <a href="/photo-analysis">ğŸ“¸ ç…§ç‰‡åˆ†æ</a>
                <a             <a href="/api-docs">ğŸ“š API æ–‡æª”</a>ref="/warning-dashboard">âš ï¸ è­¦å‘Šå°</a>
                <a href="/ml-test">ğŸ¤– MLæ¸¬è©¦</a>
                <a href="/api-docs">ğŸ“š API æ–‡æª”</a>
                <a href="/photography-guide">ğŸ“¸ æ”å½±æŒ‡å—</a>
            </div>
            <div class="nav-row">
                <a href="/best-locations">ğŸ“ æœ€ä½³åœ°é»</a>
                <a href="/faq">â“ FAQ</a>
                <a href="/weather-terms">ğŸ“š å¤©æ°£è¡“èª</a>
                <a href="/terms">ğŸ“„ æ¢æ¬¾</a>
                <a href="/privacy">ğŸ”’ ç§éš±</a>
            </div>
        </div>åœ–è¡¨åº« -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .top-nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 10px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 5px;
        }

        .nav-row:last-child {
            margin-bottom: 0;
        }

        .nav-row a {
            text-decoration: none;
            color: #333;
            padding: 8px 15px;
            border-radius: 8px;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .nav-row a:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        h1 {
            text-align: center;
            font-size: 2.5em;
            color: white;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            text-align: center;
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2em;
            margin-bottom: 40px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-icon {
            font-size: 2em;
            margin-right: 15px;
        }

        .card-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
        }

        .stat-large {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
            text-align: center;
            margin: 20px 0;
        }

        .stat-label {
            text-align: center;
            color: #666;
            font-size: 1.1em;
        }

        .chart-container {
            width: 100%;
            height: 300px;
            margin: 20px 0;
        }

        .warning-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #dc3545;
        }

        .warning-high {
            border-left-color: #dc3545;
        }

        .warning-medium {
            border-left-color: #ffc107;
        }

        .warning-low {
            border-left-color: #28a745;
        }

        .warning-time {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .warning-message {
            font-weight: 500;
            color: #333;
        }

        .insight-list {
            list-style: none;
            padding: 0;
        }

        .insight-list li {
            background: #e9ecef;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .accuracy-meter {
            background: #e9ecef;
            border-radius: 20px;
            height: 20px;
            margin: 15px 0;
            overflow: hidden;
        }

        .accuracy-fill {
            height: 100%;
            background: linear-gradient(45deg, #28a745, #20c997);
            border-radius: 20px;
            transition: width 1s ease;
        }

        .trend-indicator {
            display: inline-flex;
            align-items: center;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .trend-up {
            background: #d4edda;
            color: #155724;
        }

        .trend-down {
            background: #f8d7da;
            color: #721c24;
        }

        .trend-stable {
            background: #d1ecf1;
            color: #0c5460;
        }

        .footer {
            text-align: center;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 30px 20px;
            margin-top: 40px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: #667eea;
        }

        @media (max-width: 768px) {
            .nav-row {
                flex-wrap: wrap;
                gap: 10px;
            }

            .nav-row a {
                font-size: 12px;
                padding: 6px 10px;
            }

            .container {
                padding: 20px 10px;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 2em;
            }

            .chart-container {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <div class="nav-row">
                <a href="/" class="nav-link">ğŸ“Š å³æ™‚æ•¸æ“š</a>
                <a href="/history" class="nav-link">ï¿½ æ­·å²è¶¨å‹¢</a>
                <a href="/warning" class="nav-link">âš ï¸ è­¦å‘Šå°</a>
            </div>
            <div class="nav-row">
                <a href="/photo-analysis" class="nav-link">ğŸ“· ç…§ç‰‡åˆ†æ</a>
                <a href="/best-locations" class="nav-link">ğŸ”ï¸ æœ€ä½³ä½ç½®</a>
                <a href="/photography-guide" class="nav-link">ğŸ“¸ æ”å½±æŒ‡å—</a>
            </div>
            <div class="nav-row">
                <a href="/weather-terms" class="nav-link">ğŸŒ¤ï¸ å¤©æ°£è¡“èª</a>
                <a href="/faq" class="nav-link">â“ å¸¸è¦‹å•ç­”</a>
                <a href="/api-docs" class="nav-link">ï¿½ API æ–‡æª”</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <h1>âš ï¸ è­¦å‘Šå°</h1>
        <p class="subtitle">ç‡’å¤©é æ¸¬ç³»çµ± - è­¦å‘Šæ­·å²åˆ†æå„€è¡¨æ¿</p>

        <!-- ğŸ“Š ç¸½è¦½çµ±è¨ˆ -->
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <div class="card-header">
                    <span class="card-icon">ğŸ“Š</span>
                    <h2 class="card-title">ç¸½è¦½çµ±è¨ˆ</h2>
                </div>
                <div class="stat-large" id="totalWarnings">256</div>
                <div class="stat-label">ç¸½è­¦å‘Šæ•¸é‡</div>
                <hr style="margin: 20px 0; border: none; border-top: 1px solid #e9ecef;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: center;">
                    <div>
                        <div style="font-size: 1.5em; font-weight: bold; color: #dc3545;">87</div>
                        <div style="font-size: 0.9em; color: #666;">é«˜åš´é‡åº¦</div>
                    </div>
                    <div>
                        <div style="font-size: 1.5em; font-weight: bold; color: #ffc107;">123</div>
                        <div style="font-size: 0.9em; color: #666;">ä¸­åš´é‡åº¦</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-card">
                <div class="card-header">
                    <span class="card-icon">ğŸ¯</span>
                    <h2 class="card-title">é æ¸¬æº–ç¢ºæ€§</h2>
                </div>
                <div class="stat-large" style="color: #28a745;">87.3%</div>
                <div class="stat-label">ç¸½é«”æº–ç¢ºç‡</div>
                <div class="accuracy-meter">
                    <div class="accuracy-fill" style="width: 87.3%;"></div>
                </div>
                <div style="text-align: center; color: #666; font-size: 0.9em;">
                    <span class="trend-indicator trend-up">ğŸ“ˆ è¼ƒä¸Šæœˆæå‡ 2.1%</span>
                </div>
            </div>

            <div class="dashboard-card">
                <div class="card-header">
                    <span class="card-icon">ğŸ•</span>
                    <h2 class="card-title">æ™‚é–“æ¨¡å¼</h2>
                </div>
                <div style="text-align: center; margin: 20px 0;">
                    <div style="font-size: 1.8em; font-weight: bold; color: #667eea;">18:30-19:00</div>
                    <div style="color: #666; margin-bottom: 15px;">æœ€é«˜è­¦å‘Šæ™‚æ®µ</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9em;">
                        <div>é€±æœ«: <strong>68%</strong></div>
                        <div>å·¥ä½œæ—¥: <strong>42%</strong></div>
                    </div>
                </div>
            </div>

            <div class="dashboard-card">
                <div class="card-header">
                    <span class="card-icon">ğŸŒ±</span>
                    <h2 class="card-title">å­£ç¯€æ€§è¶¨å‹¢</h2>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: center;">
                    <div>
                        <div style="font-size: 1.2em; font-weight: bold; color: #ff6b6b;">å†¬å­£</div>
                        <div style="color: #666;">45% ç‡’å¤©æ©Ÿç‡</div>
                    </div>
                    <div>
                        <div style="font-size: 1.2em; font-weight: bold; color: #4ecdc4;">å¤å­£</div>
                        <div style="color: #666;">23% ç‡’å¤©æ©Ÿç‡</div>
                    </div>
                </div>
                <div style="margin-top: 15px; text-align: center;">
                    <span class="trend-indicator trend-up">ğŸ“ˆ ç•¶å‰å­£ç¯€è¶¨å‹¢è‰¯å¥½</span>
                </div>
            </div>
        </div>

        <!-- ğŸ“ˆ è­¦å‘Šæ™‚é–“è»¸ -->
        <div class="dashboard-card" style="margin-bottom: 30px;">
            <div class="card-header">
                <span class="card-icon">ğŸ“ˆ</span>
                <h2 class="card-title">è­¦å‘Šæ™‚é–“è»¸</h2>
            </div>
            <div class="chart-container">
                <canvas id="warningTimelineChart"></canvas>
            </div>
        </div>

        <!-- âš ï¸ åš´é‡ç¨‹åº¦åˆ†æ -->
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <div class="card-header">
                    <span class="card-icon">âš ï¸</span>
                    <h2 class="card-title">åš´é‡ç¨‹åº¦åˆ†æ</h2>
                </div>
                <div class="chart-container">
                    <canvas id="severityChart"></canvas>
                </div>
            </div>

            <div class="dashboard-card">
                <div class="card-header">
                    <span class="card-icon">ğŸ’¡</span>
                    <h2 class="card-title">æ•¸æ“šæ´å¯Ÿèˆ‡å»ºè­°</h2>
                </div>
                <ul class="insight-list">
                    <li>å†¬å­£æœˆä»½ (12-2æœˆ) ç‡’å¤©æ©Ÿç‡æœ€é«˜ï¼Œå»ºè­°é‡é»é—œæ³¨</li>
                    <li>ä¸‹åˆ 6:30-7:00 æ˜¯ç‡’å¤©é è­¦é«˜å³°æ™‚æ®µ</li>
                    <li>æ¿•åº¦ 60-80% ç¯„åœå…§ç‡’å¤©ç™¼ç”Ÿæ©Ÿç‡å¢åŠ  35%</li>
                    <li>æ±åŒ—é¢¨å¤©æ°£å‹æ…‹ä¸‹ç‡’å¤©é æ¸¬æº–ç¢ºç‡é” 91%</li>
                    <li>å»ºè­°åœ¨é æ¸¬è©•åˆ† >70 æ™‚æå‰ 30 åˆ†é˜å‰å¾€æ‹æ”åœ°é»</li>
                </ul>
            </div>
        </div>

        <!-- ğŸ”¥ é«˜å½±éŸ¿è­¦å‘Š -->
        <div class="dashboard-card" style="margin-bottom: 30px;">
            <div class="card-header">
                <span class="card-icon">ğŸ”¥</span>
                <h2 class="card-title">è¿‘æœŸé«˜å½±éŸ¿è­¦å‘Š</h2>
            </div>
            <div class="warning-item warning-high">
                <div class="warning-time">2024-12-28 18:45</div>
                <div class="warning-message">æ¥µä½³ç‡’å¤©æ¢ä»¶ï¼šé æ¸¬è©•åˆ† 95/100ï¼ŒæŒçºŒæ™‚é–“ 25 åˆ†é˜</div>
            </div>
            <div class="warning-item warning-high">
                <div class="warning-time">2024-12-25 19:10</div>
                <div class="warning-message">è–èª•ç¯€ç‡’å¤©ç››å®´ï¼šé æ¸¬è©•åˆ† 92/100ï¼Œè¦†è“‹å…¨æ¸¯</div>
            </div>
            <div class="warning-item warning-medium">
                <div class="warning-time">2024-12-22 18:30</div>
                <div class="warning-message">ä¸­ç­‰ç‡’å¤©æ¢ä»¶ï¼šé æ¸¬è©•åˆ† 78/100ï¼Œå»ºè­°è¥¿å€æ‹æ”</div>
            </div>
            <div class="warning-item warning-medium">
                <div class="warning-time">2024-12-20 19:05</div>
                <div class="warning-message">å±€éƒ¨ç‡’å¤©ç¾è±¡ï¼šé æ¸¬è©•åˆ† 71/100ï¼Œç¶­æ¸¯æ±éƒ¨è¼ƒä½³</div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-links">
            <a href="/">ğŸ  é¦–é </a>
            <a href="/photo-analysis">ğŸ“¸ ç…§ç‰‡åˆ†æ</a>
            <a href="/warning-dashboard">âš ï¸ è­¦å‘Šå°</a>
            <a href="/ml-test">ğŸ¤– MLæ¸¬è©¦</a>
            <a href="/api-docs">ï¿½ API æ–‡æª”</a>
            <a href="/photography-guide">ğŸ“¸ æ”å½±æŒ‡å—</a>
            <a href="/best-locations">ğŸ“ æœ€ä½³åœ°é»</a>
            <a href="/faq">â“ FAQ</a>
            <a href="/weather-terms">ğŸ“š å¤©æ°£è¡“èª</a>
            <a href="/terms">ğŸ“„ æ¢æ¬¾</a>
            <a href="/privacy">ğŸ”’ ç§éš±</a>
        </div>
        <p>&copy; 2024 BurnSky ç‡’å¤©é æ¸¬ç³»çµ±. ç‚ºæ”å½±æ„›å¥½è€…æä¾›ç²¾æº–çš„ç«ç‡’é›²é æ¸¬æœå‹™.</p>
    </footer>

    <script>
        // å…¨å±€è®Šæ•¸å­˜å„²æ•¸æ“šå’Œåœ–è¡¨
        let dashboardData = null;
        let timelineChart = null;
        let severityChart = null;

        // ç²å–è­¦å‘Šå°æ•¸æ“š
        async function loadDashboardData() {
            try {
                console.log('æ­£åœ¨è¼‰å…¥è­¦å‘Šå°æ•¸æ“š...');
                const response = await fetch('/api/warning-dashboard-data');
                console.log('API å›æ‡‰ç‹€æ…‹:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                dashboardData = await response.json();
                console.log('æˆåŠŸç²å–æ•¸æ“š:', dashboardData);
                
                // æ›´æ–°é é¢å…§å®¹
                updateOverviewStats();
                updateAccuracySection();
                updateTimePattern();
                updateSeasonalTrends();
                updateCharts();
                updateHighImpactWarnings();
                updateInsights();
                
                console.log('æ‰€æœ‰æ•¸æ“šæ›´æ–°å®Œæˆ');
                
            } catch (error) {
                console.error('è¼‰å…¥è­¦å‘Šå°æ•¸æ“šå¤±æ•—:', error);
                console.log('ä½¿ç”¨éœæ…‹æ•¸æ“šä½œç‚ºå‚™ä»½');
                // ä½¿ç”¨éœæ…‹æ•¸æ“šä½œç‚ºå‚™ä»½
                loadStaticData();
            }
        }

        // æ›´æ–°ç¸½è¦½çµ±è¨ˆ
        function updateOverviewStats() {
            if (!dashboardData) return;
            
            const overview = dashboardData.overview;
            document.getElementById('totalWarnings').textContent = overview.total_warnings;
            
            // æ›´æ–°é«˜åš´é‡åº¦å’Œä¸­åš´é‡åº¦æ•¸æ“š
            const highSeverityEl = document.querySelector('[style*="color: #dc3545"]');
            const mediumSeverityEl = document.querySelector('[style*="color: #ffc107"]');
            
            if (highSeverityEl) {
                highSeverityEl.textContent = overview.high_warnings;
            }
            if (mediumSeverityEl) {
                mediumSeverityEl.textContent = overview.medium_warnings;
            }
        }

        // æ›´æ–°æº–ç¢ºæ€§æ•¸æ“š
        function updateAccuracySection() {
            if (!dashboardData) return;
            
            const accuracy = dashboardData.accuracy;
            const accuracyEl = document.querySelector('.stat-large[style*="color: #28a745"]');
            const accuracyFill = document.querySelector('.accuracy-fill');
            const trendEl = document.querySelector('.trend-indicator');
            
            if (accuracyEl) {
                accuracyEl.textContent = accuracy.percentage + '%';
            }
            if (accuracyFill) {
                accuracyFill.style.width = accuracy.percentage + '%';
            }
            if (trendEl) {
                const trendText = accuracy.trend === 'up' ? 'ğŸ“ˆ è¼ƒä¸Šæœˆæå‡ 2.1%' : 'ğŸ“Š ä¿æŒç©©å®š';
                trendEl.textContent = trendText;
                trendEl.className = accuracy.trend === 'up' ? 'trend-indicator trend-up' : 'trend-indicator trend-stable';
            }
        }

        // æ›´æ–°æ™‚é–“æ¨¡å¼
        function updateTimePattern() {
            if (!dashboardData) return;
            
            const timePattern = dashboardData.time_pattern;
            const peakHourEl = document.querySelector('div[style*="font-size: 1.8em"]');
            
            // ä½¿ç”¨æ›´å®‰å…¨çš„æ–¹å¼æŸ¥æ‰¾åŒ…å«ç‰¹å®šæ–‡å­—çš„å…ƒç´ 
            const allDivs = document.querySelectorAll('div');
            let weekendEl = null;
            let weekdayEl = null;
            
            for (let div of allDivs) {
                if (div.textContent && div.textContent.includes('é€±æœ«:')) {
                    weekendEl = div;
                }
                if (div.textContent && div.textContent.includes('å·¥ä½œæ—¥:')) {
                    weekdayEl = div;
                }
            }
            
            if (peakHourEl) {
                peakHourEl.textContent = timePattern.peak_hour;
            }
            
            // å¯ä»¥åœ¨é€™è£¡æ›´æ–°é€±æœ«å’Œå·¥ä½œæ—¥æ•¸æ“šï¼Œå¦‚æœæ‰¾åˆ°å°æ‡‰å…ƒç´ 
            // if (weekendEl) { weekendEl.textContent = `é€±æœ«: ${timePattern.weekend_ratio}%`; }
            // if (weekdayEl) { weekdayEl.textContent = `å·¥ä½œæ—¥: ${timePattern.weekday_ratio}%`; }
        }

        // æ›´æ–°å­£ç¯€æ€§è¶¨å‹¢
        function updateSeasonalTrends() {
            if (!dashboardData) return;
            
            const seasonal = dashboardData.seasonal;
            const winterEl = document.querySelector('div[style*="color: #ff6b6b"] + div');
            const summerEl = document.querySelector('div[style*="color: #4ecdc4"] + div');
            
            if (winterEl) {
                winterEl.textContent = seasonal.winter_probability + '% ç‡’å¤©æ©Ÿç‡';
            }
            if (summerEl) {
                summerEl.textContent = seasonal.summer_probability + '% ç‡’å¤©æ©Ÿç‡';
            }
        }

        // æ›´æ–°åœ–è¡¨
        function updateCharts() {
            if (!dashboardData) return;
            
            // è­¦å‘Šæ™‚é–“è»¸åœ–è¡¨
            const timelineCtx = document.getElementById('warningTimelineChart').getContext('2d');
            
            const monthLabels = dashboardData.monthly_timeline.map(item => item.month);
            const totalData = dashboardData.monthly_timeline.map(item => item.total);
            const highData = dashboardData.monthly_timeline.map(item => item.high);
            
            if (timelineChart) {
                timelineChart.destroy();
            }
            
            timelineChart = new Chart(timelineCtx, {
                type: 'line',
                data: {
                    labels: monthLabels,
                    datasets: [{
                        label: 'è­¦å‘Šæ•¸é‡',
                        data: totalData,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'é«˜åš´é‡åº¦è­¦å‘Š',
                        data: highData,
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.1)',
                        fill: false,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        }
                    }
                }
            });

            // åš´é‡ç¨‹åº¦åˆ†æåœ–è¡¨
            const severityCtx = document.getElementById('severityChart').getContext('2d');
            
            if (severityChart) {
                severityChart.destroy();
            }
            
            severityChart = new Chart(severityCtx, {
                type: 'doughnut',
                data: {
                    labels: ['é«˜åš´é‡åº¦', 'ä¸­åš´é‡åº¦', 'ä½åš´é‡åº¦'],
                    datasets: [{
                        data: [
                            dashboardData.overview.high_warnings,
                            dashboardData.overview.medium_warnings,
                            dashboardData.overview.low_warnings
                        ],
                        backgroundColor: [
                            '#dc3545',
                            '#ffc107',
                            '#28a745'
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // æ›´æ–°é«˜å½±éŸ¿è­¦å‘Š
        function updateHighImpactWarnings() {
            if (!dashboardData) return;
            
            // ä½¿ç”¨æ›´å®‰å…¨çš„æ–¹å¼æŸ¥æ‰¾å®¹å™¨
            let warningsContainer = null;
            const h2Elements = document.querySelectorAll('.dashboard-card h2');
            
            for (let h2 of h2Elements) {
                if (h2.textContent && h2.textContent.includes('è¿‘æœŸé«˜å½±éŸ¿è­¦å‘Š')) {
                    warningsContainer = h2.parentNode.parentNode;
                    break;
                }
            }
            
            if (!warningsContainer) {
                console.error('æ‰¾ä¸åˆ°é«˜å½±éŸ¿è­¦å‘Šå®¹å™¨');
                return;
            }
            
            const existingWarnings = warningsContainer.querySelectorAll('.warning-item');
            existingWarnings.forEach(item => item.remove());
            
            dashboardData.high_impact_warnings.forEach(warning => {
                const warningDiv = document.createElement('div');
                warningDiv.className = `warning-item ${warning.severity_class}`;
                warningDiv.innerHTML = `
                    <div class="warning-time">${warning.time}</div>
                    <div class="warning-message">${warning.message}</div>
                `;
                warningsContainer.appendChild(warningDiv);
            });
        }

        // æ›´æ–°æ•¸æ“šæ´å¯Ÿ
        function updateInsights() {
            if (!dashboardData) return;
            
            const insightsList = document.querySelector('.insight-list');
            insightsList.innerHTML = '';
            
            dashboardData.insights.forEach(insight => {
                const li = document.createElement('li');
                li.textContent = insight;
                insightsList.appendChild(li);
            });
        }

        // éœæ…‹æ•¸æ“šå‚™ä»½
        function loadStaticData() {
            dashboardData = {
                overview: {
                    total_warnings: 256,
                    high_warnings: 87,
                    medium_warnings: 123,
                    low_warnings: 46
                },
                accuracy: {
                    percentage: 87.3,
                    trend: 'up'
                },
                time_pattern: {
                    peak_hour: '18:30-19:00',
                    weekend_ratio: 68,
                    weekday_ratio: 42
                },
                seasonal: {
                    winter_probability: 45,
                    summer_probability: 23,
                    current_trend: 'up'
                },
                monthly_timeline: [
                    {month: '1æœˆ', total: 45, high: 18},
                    {month: '2æœˆ', total: 52, high: 22},
                    {month: '3æœˆ', total: 38, high: 15},
                    {month: '4æœˆ', total: 25, high: 8},
                    {month: '5æœˆ', total: 18, high: 5},
                    {month: '6æœˆ', total: 12, high: 3},
                    {month: '7æœˆ', total: 8, high: 2},
                    {month: '8æœˆ', total: 15, high: 4},
                    {month: '9æœˆ', total: 22, high: 7},
                    {month: '10æœˆ', total: 35, high: 12},
                    {month: '11æœˆ', total: 42, high: 16},
                    {month: '12æœˆ', total: 48, high: 19}
                ],
                high_impact_warnings: [
                    {
                        time: '2024-12-28 18:45',
                        message: 'æ¥µä½³ç‡’å¤©æ¢ä»¶ï¼šé æ¸¬è©•åˆ† 95/100ï¼ŒæŒçºŒæ™‚é–“ 25 åˆ†é˜',
                        severity_class: 'warning-high'
                    },
                    {
                        time: '2024-12-25 19:10',
                        message: 'è–èª•ç¯€ç‡’å¤©ç››å®´ï¼šé æ¸¬è©•åˆ† 92/100ï¼Œè¦†è“‹å…¨æ¸¯',
                        severity_class: 'warning-high'
                    },
                    {
                        time: '2024-12-22 18:30',
                        message: 'ä¸­ç­‰ç‡’å¤©æ¢ä»¶ï¼šé æ¸¬è©•åˆ† 78/100ï¼Œå»ºè­°è¥¿å€æ‹æ”',
                        severity_class: 'warning-medium'
                    },
                    {
                        time: '2024-12-20 19:05',
                        message: 'å±€éƒ¨ç‡’å¤©ç¾è±¡ï¼šé æ¸¬è©•åˆ† 71/100ï¼Œç¶­æ¸¯æ±éƒ¨è¼ƒä½³',
                        severity_class: 'warning-medium'
                    }
                ],
                insights: [
                    "å†¬å­£æœˆä»½ (12-2æœˆ) ç‡’å¤©æ©Ÿç‡æœ€é«˜ï¼Œå»ºè­°é‡é»é—œæ³¨",
                    "ä¸‹åˆ 6:30-7:00 æ˜¯ç‡’å¤©é è­¦é«˜å³°æ™‚æ®µ",
                    "æ¿•åº¦ 60-80% ç¯„åœå…§ç‡’å¤©ç™¼ç”Ÿæ©Ÿç‡å¢åŠ  35%",
                    "æ±åŒ—é¢¨å¤©æ°£å‹æ…‹ä¸‹ç‡’å¤©é æ¸¬æº–ç¢ºç‡é” 91%",
                    "å»ºè­°åœ¨é æ¸¬è©•åˆ† >70 æ™‚æå‰ 30 åˆ†é˜å‰å¾€æ‹æ”åœ°é»"
                ]
            };
            
            updateOverviewStats();
            updateAccuracySection();
            updateTimePattern();
            updateSeasonalTrends();
            updateCharts();
            updateHighImpactWarnings();
            updateInsights();
        }

        // æ•¸å­—å‹•ç•«æ•ˆæœ
        function animateNumbers() {
            const statNumbers = document.querySelectorAll('.stat-large');
            statNumbers.forEach(stat => {
                const finalValue = parseFloat(stat.textContent);
                let currentValue = 0;
                const increment = finalValue / 50;
                
                const timer = setInterval(() => {
                    currentValue += increment;
                    if (currentValue >= finalValue) {
                        currentValue = finalValue;
                        clearInterval(timer);
                    }
                    
                    if (stat.textContent.includes('%')) {
                        stat.textContent = currentValue.toFixed(1) + '%';
                    } else {
                        stat.textContent = Math.floor(currentValue);
                    }
                }, 50);
            });
        }

        // å¡ç‰‡é€²å ´å‹•ç•«
        function animateCards() {
            const cards = document.querySelectorAll('.dashboard-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        // é é¢åŠ è¼‰å®Œæˆå¾ŒåŸ·è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é é¢ DOM è¼‰å…¥å®Œæˆ');
            
            // æª¢æŸ¥ Chart.js æ˜¯å¦è¼‰å…¥
            if (typeof Chart === 'undefined') {
                console.error('âŒ Chart.js æœªè¼‰å…¥');
                return;
            }
            console.log('âœ… Chart.js å·²è¼‰å…¥');
            
            // æª¢æŸ¥åœ–è¡¨å…ƒç´ æ˜¯å¦å­˜åœ¨
            const timelineElement = document.getElementById('warningTimelineChart');
            const severityElement = document.getElementById('severityChart');
            
            if (!timelineElement) {
                console.error('âŒ warningTimelineChart å…ƒç´ æœªæ‰¾åˆ°');
            } else {
                console.log('âœ… warningTimelineChart å…ƒç´ å­˜åœ¨');
            }
            
            if (!severityElement) {
                console.error('âŒ severityChart å…ƒç´ æœªæ‰¾åˆ°');
            } else {
                console.log('âœ… severityChart å…ƒç´ å­˜åœ¨');
            }
            
            // è¼‰å…¥æ•¸æ“š
            loadDashboardData();
            
            // å•Ÿå‹•å‹•ç•«
            setTimeout(() => {
                animateNumbers();
                animateCards();
            }, 100);
        });
    </script>
</body>
</html>
